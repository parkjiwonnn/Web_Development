# Token authentication

토큰 기반 인증: 사용자가 자신의 신원을 확인하고, 이에 대한 보상으로 고유한 접근 토큰을 받는 프로토콜

- 토큰이 유효한 동안에는 해당 토큰이 발급된 웹사이트나 앱에 다시 접속할 때마다 자격 증명을 재입력할 필요 없이 접근할 수 있음
- 동일한 웹 페이지, 앱, 또는 해당 토큰으로 보호된 리소스에 반복적으로 접근할 수 있게 해줌
- 사용자는 토큰이 유효한 동안 접근 권한을 유지하며, 사용자가 로그아웃하거나 앱을 종료하면 토큰 무효화
- 토큰 기반 인증은 기존의 비밀번호 기반 또는 서버 기반 인증 방식과 다름
- 토큰은 추가적인 보안 계층을 제공하며, 관리자는 각 작업과 거래에 대한 세부적인 제어 권한을 가질 수 있음

## A History of Authentication Tokens

인증(Authentication)과 권한 부여(Authorization)는 서로 다른 개념

인증 토큰이 등장하기 전에는 비밀번호와 서버를 사용하여 적합한 사람이 적절한 시점에 적합한 리소스에 접근할 수 있도록 전통적인 방식으로 보안을 유지했음

(ex) 비밀번호  
User generation: 사용자가 문자, 숫자, 특수 문자를 조합하여 비밀번호를 생성
Memory: 사용자는 이 고유한 조합을 기억  
Repetition: 사용자가 접근할 때마다 비밀번호를 입력

- 비밀번호를 기억하기 위해 적어두거나 같은 비밀번호를 여러 곳에 반복하여 사용하면 도난이 발생하기 쉬움
- 비밀번호 기반 인증은 서버 인증을 요구함
- 사용자가 로그인할 때마다 컴퓨터가 해당 거래를 기록하며, 서버의 메모리 사용량이 증가함

**토큰 인증**

토큰 인증에서는 별도의 서비스가 서버 요청을 확인함  
확인이 완료되면 서버는 토큰을 발급하고 요청에 응답

- 여전히 사용자가 기억해야 할 비밀번호가 하나 있을 수 있지만, 토큰은 훨씬 도난당하기 어려운 또 다른 접근 방법을 제공함
- 세션 기록이 서버에 저장되지 않아 서버 메모리의 부담이 없음

## 3 Authentication Token Types

모든 인증 토큰은 접근을 허용하지만, 각 유형마다 작동 방식에 약간의 차이가 있음

- 연결형(Connected): 키, 디스크, 드라이브와 같은 물리적 장치가 시스템에 연결되어 접근 권한을 부여함
  - (ex) USB 장치나 스마트카드를 사용해 시스템에 로그인한 경험
- 비접촉형(Contactless): 장치가 서버와 통신할 수 있을 만큼 가까이 있지만, 직접 연결되지는 않음
  - (ex) Microsoft 'magic ring'
- 비연결형(Disconnected): 장치가 다른 장치에 물리적으로 접촉하지 않더라도 멀리 떨어진 서버와 통신할 수 있음
  - (ex) 휴대폰을 사용하여 이중 인증 절차 완료

이 세 가지 방법 모두에서 사용자는 인증 과정을 시작하기 위해 무언가를 해야 함(비밀번호를 입력하거나 질문에 답하는 것 등)  
하지만 이러한 초기 단계들을 완벽하게 수행해도, 접근 토큰 없이는 접근할 수 없음

## Token Authentication in 4 Easy Steps

토큰 기반 인증 시스템을 사용하면 방문자는 자격 증명을 한 번만 확인받음  
그 후 일정 기간 동안 액세스할 수 있는 토큰을 발급받게 됨

- 요청(Request): 사용자가 서버 또는 보호된 리소스에 대한 접근을 요청함
  - 비밀번호를 입력하는 로그인일 수도 있고, 사용자가 설정한 다른 방식일 수도 있음
- 검증(Verification): 서버는 사용자가 접근 권한이 있는지 확인
  - 사용자 이름과 비밀번호를 대조하는 방식이거나, 다른 검증 절차일 수 있음
- 토큰(Token): 서버는 인증 장치(반지, 키, 휴대폰 등)와 통신하여 검증 후 토큰을 발급해 사용자에게 전달
- 저장(Storage): 토큰은 사용자가 작업을 진행하는 동안 브라우저 내에 저장됨

사용자가 서버의 다른 영역에 접근하려고 할 때, 토큰이 서버와 다시 통신하여 접근 허가 여부가 결정됨  
관리자는 토큰의 사용 제한을 설정할 수 있음  
사용자가 로그아웃하면 즉시 삭제되는 일회용 토큰을 허용하거나, 특정 시간이 지나면 자동 삭제되도록 설정할 수도 있음

## JSON Web Token (JWT): A Special Form of Auth Token

JSON 웹 토큰(JWT)은 개방형 표준으로, 두 당사자 간에 안전한 통신을 가능하게 함  
데이터는 디지털 서명으로 검증되며, HTTP를 통해 전송될 때 암호화되어 안전하게 보호됨

JWT는 세 가지 주요 구성 요소로 이루어져 있음

- 헤더(Header): 이 영역에서는 토큰의 유형과 서명 알고리즘을 정의
- 페이로드(Payload): 토큰 발급자, 토큰의 만료 시간 등을 정의
- 서명(Signature): 안전한 서명을 통해 메시지가 전송 중에 변경되지 않았음을 확인  
  이 세 가지 요소는 코딩을 통해 하나의 토큰으로 결합됨

## Pros & Cons of JWTs

JWT의 장점

- 크기: 이 코딩 언어로 작성된 토큰은 매우 작아서 두 엔터티 간에 빠르게 전달될 수 있음
- 편의성: 거의 모든 곳에서 토큰을 생성할 수 있으며, 서버에서 검증할 필요가 없음
- 제어력: 누가 어떤 리소스에 접근할 수 있는지, 그 권한이 얼마나 지속되는지, 로그인 상태에서 어떤 작업을 수행할 수 있는지 지정할 수 있음

JWT의 단점

- 단일 키 의존성: JWT는 단일 키에 의존하기 때문에, 이 키가 유출되면 시스템 전체가 위험에 처할 수 있음
- 복잡성: 암호화 서명 알고리즘에 대한 지식이 부족한 개발자는 시스템을 위험에 빠뜨릴 수 있음
- 제한 사항: 모든 클라이언트에게 메시지를 푸시하거나 서버 측에서 클라이언트를 관리할 수 없음

## Why Should You Try Authorization Tokens?

- 일시적인 접근 권한을 자주 부여해야 할 경우

  - 사용자 수가 날짜, 시간, 또는 특정 이벤트에 따라 변동하는 경우, 접근 권한을 반복해서 부여하고 철회하는 과정은 매우 부담스러울 수 있음
  - 토큰을 사용하면 이 과정이 간소화될 수 있음

- 세분화된 접근 권한이 필요한 경우

  - 서버가 특정 사용자 속성이 아닌 특정 문서 속성에 따라 접근 권한을 부여하는 경우, 비밀번호로는 이러한 세부적인 접근 제어가 어려움
  - 예를 들어, 온라인 저널을 운영하는 경우, 모든 사용자가 특정 문서에 대해서만 읽고 댓글을 달 수 있도록 허용하고 다른 문서에는 접근하지 못하게 할 수 있음

- 해킹의 주요 대상이 되는 경우
  - 서버에 치명적인 손해를 끼칠 수 있는 민감한 문서가 포함되어 있다면, 비밀번호만으로는 충분한 보호가 되지 않음
  - 하드웨어 기반의 토큰 사용은 보안을 한층 강화하는 데 도움이 될 수 있음

## Follow Authentication Token Best Practices

인증 토큰은 보안 프로토콜을 강화하고 서버를 안전하게 유지하기 위한 수단이지만, 보안을 염두에 둔 프로세스를 구축하지 않으면 효과적으로 작동하지 않을 수 있음

- 비공개 유지

  - 사용자들은 인증 토큰 장치를 공유하거나 부서 간에 전달해서는 안 됨
  - 비밀번호를 공유하지 않는 것처럼, 보안 시스템의 어떤 부분도 공유해서는 안 됨

- 보안 연결

  - 토큰과 서버 간의 통신은 HTTPS 연결을 통해 보안이 유지되어야 함
  - 암호화는 토큰을 안전하게 유지하는 데 중요한 역할

- 정기 테스트

  - 주기적으로 토큰 테스트를 실행하여 시스템이 안전하고 제대로 작동하는지 확인하고 문제가 발견되면 신속히 해결해야 함

- 적합성
  - 특정 용도에 맞는 올바른 토큰 유형을 선택해야 함
  - 예를 들어, JWT는 세션 토큰에는 적합하지 않을 수 있음, 비용이 많이 들고 가로채기와 관련된 보안 위험을 완전히 제거하기 어렵기 때문

## 참고

https://www.okta.com/identity-101/what-is-token-based-authentication/
