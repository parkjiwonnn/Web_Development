# JWT

JWT (JSON Web Token)은 웹 애플리케이션과 API에서 보안을 강화하기 위해 점점 더 널리 사용되는 인증 방식

## What Is JWT?

JWT(JSON Web Token)는 클라이언트와 서버, 즉 두 당사자 간에 보안 정보를 공유하기 위해 사용하는 오픈 표준  
각 JWT에는 인코딩된 JSON 객체와 함께 일련의 '클레임(Claims)'이 포함되어 있음  
JWT는 발급 후 클레임이 수정되지 않도록 하기 위해 암호화 알고리즘으로 서명됨

### What Is JSON?

JSON은 JavaScript Object Notation의 약자로, 웹 애플리케이션 간 데이터를 전달하기 위한 텍스트 기반 포맷  
JSON은 개발자와 컴퓨터 모두가 쉽게 접근할 수 있도록 정보를 저장하며, 대부분의 프로그래밍 언어에서 데이터 포맷으로 사용될 수 있음  
XML을 넘어 API의 선호 구문으로 빠르게 자리 잡고 있음

### What Are Tokens?

토큰은 신원을 나타내는 데이터 문자열  
인증의 경우, JWT가 아닌 토큰은 발신자의 신원을 검증할 수 있도록 수신자에게 제공되는 문자열  
중요한 차이점은 해당 문자열 자체는 의미를 갖지 않는다는 점

## How JWT Works

JWT는 다른 웹 토큰과 달리 클레임(Claims)이라는 정보를 포함하고 있음  
클레임은 두 당사자 간의 정보를 전달하기 위해 사용됨  
어떤 클레임이 포함되는지는 상황에 따라 달라지며, 토큰을 발급한 주체, 유효 기간, 클라이언트에게 부여된 권한 등을 클레임으로 나타낼 수 있음

JWT는 마침표(.)로 구분된 세 부분으로 이루어진 문자열이며, Base64로 직렬화됨  
가장 일반적인 직렬화 형식인 ‘Compact Serialization’에서는 다음과 같은 형태를 띔: xxxxx.yyyyy.zzzzz.

이를 디코딩하면 두 개의 JSON 문자열이 나타남:

- 헤더와 페이로드 (Payload)
- 서명 (Signature)

### 헤더 (Header)

JOSE(JSON Object Signing and Encryption) 헤더는 토큰의 유형(이 경우 JWT)과 서명 알고리즘을 포함

### 페이로드 (Payload)

페이로드에는 클레임이 포함됨  
이는 JSON 문자열로 표현되며, JWT를 간결하게 유지하기 위해 일반적으로 12개 이하의 필드로 구성  
이 정보는 서버가 사용자가 요청한 작업을 수행할 권한이 있는지 확인하는 데 주로 사용

JWT에는 필수 클레임이 없지만, 표준에 따라 특정 클레임이 필수가 될 수 있음  
예를 들어, OAuth2.0에서 JWT를 'Bearer Access Token'으로 사용할 경우 iss(발급자), sub(주체), aud(수신자), exp(만료 시간) 등이 포함되어야 함

### 서명 (Signature)

서명은 토큰이 변경되지 않았음을 보장함  
JWT를 생성하는 당사자는 헤더와 페이로드를 비밀 키 또는 발신자만 알고 있는 개인 키로 서명  
토큰이 사용될 때, 수신자는 서명을 검증하여 헤더와 페이로드가 일치하는지 확인

## JWT Example: OAuth Bearer Tokens

JWT를 사용하는 일반적인 방법 중 하나는 OAuth Bearer Tokens으로 활용하는 것

- 인증 서버는 클라이언트의 요청에 따라 JWT를 생성하고, 다른 당사자가 수정하지 못하도록 서명함
- 이후 클라이언트는 이 JWT를 REST API 요청에 포함하여 전송
- REST API는 JWT의 서명과 페이로드, 헤더를 비교해 유효성을 확인
- JWT가 유효하다고 확인되면, API는 클레임을 바탕으로 클라이언트의 요청을 승인하거나 거절할 수 있음

JWT Bearer Tokens을 보안 건물에 들어가기 위한 신분증으로 생각할 수 있음

- 이 신분증에는 특정 권한(클레임)이 포함되어 있으며, 이는 건물 내 특정 구역에만 접근할 수 있도록 제한하는 역할
- 이 비유에서 인증 서버는 접수 데스크, 즉 신분증 발급자에 해당
- 신분증의 유효성을 확인하기 위해 신분증에 회사 로고가 인쇄되어 있는 것처럼, JWT에도 서명이 포함되어 있음
- 신분증 소유자가 제한된 구역에 접근하려고 할 때, 신분증에 포함된 권한이 해당 구역에 접근할 수 있는지를 결정하게 되며, 이는 JWT의 클레임과 유사함

## 참고

https://www.akana.com/blog/what-is-jwt
